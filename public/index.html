<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gas Detector Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gauge {
            position: relative;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: conic-gradient(
                #10B981 0% 33%,
                #F59E0B 33% 66%,
                #EF4444 66% 100%
            );
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .gauge-inner {
            width: 80%;
            height: 80%;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.5rem;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
<div class="container mx-auto px-4 py-8">
    <!-- Header -->
   <header class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold text-gray-800">Gas Detector Dashboard</h1>
                <p class="text-gray-600">Real-time monitoring system</p>
            </div>
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <i class="fas fa-bell text-gray-600 text-xl"></i>
                    <span class="absolute top-0 right-0 h-3 w-3 bg-red-500 rounded-full"></span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="h-10 w-10 bg-blue-500 rounded-full flex items-center justify-center text-white">
                        <i class="fas fa-user"></i>
                    </div>
                    <span class="font-medium">Admin</span>
                </div>
            </div>
        </header>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <!-- Gas Level -->
        <div class="bg-white rounded-xl shadow-md p-6">
            <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">Current Gas Level</h2>
                    <div class="h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600">
                        <i class="fas fa-fire"></i>
                    </div>
            </div>
            <div class="flex flex-col items-center">
                <div class="gauge mb-4">
                    <div class="gauge-inner">
                        <span id="gasPercentage">-- %</span>
                    </div>
                </div>
                <div id="gasStatus" class="px-4 py-2 rounded-full text-white font-medium bg-green-500">
                    <i class="fas fa-check-circle mr-2"></i> --
                </div>
            </div>
        </div>

        <!-- Gas Weight -->
        <div class="bg-white rounded-xl shadow-md p-6">
            <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">Current Weight</h2>
                    <div class="h-10 w-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-600">
                        <i class="fas fa-weight-hanging"></i>
                    </div>
            </div>
            <div class="flex flex-col items-center justify-center h-full">
                    <div class="text-5xl font-bold text-gray-800 mb-2" id="gasWeight">-- kg</div>
            </div>
        </div>

        <!-- Battery Level -->
        <div class="bg-white rounded-xl shadow-md p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Battery Level</h2>
                <div class="h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600">
                    <i class="fas fa-battery-three-quarters"></i>
                </div>
            </div>
            <div class="flex flex-col items-center">
                <div class="flex flex-col items-center justify-center h-full">
                    <div class="text-4xl font-bold text-gray-800 mb-2" id="batteryLevel">--%</div>
                </div>
                <div id="batteryStatus" class="mt-4 px-4 py-2 rounded-full text-white font-medium bg-green-500">
                    <i class="fas fa-check-circle mr-2"></i> --
                </div>
            </div>
    </div>
</div>
    </div>

    <!-- Alerts -->
    <div id="alertContainer" class="mb-6"></div>
</div>

<script>
    const gasPercentage = document.getElementById('gasPercentage');
    const gasWeight = document.getElementById('gasWeight');
    const gasStatus = document.getElementById('gasStatus');
    const batteryStatus = document.getElementById('batteryStatus');
    const batteryLevel = document.getElementById('batteryLevel');
    const alertContainer = document.getElementById('alertContainer');

    const socket = new WebSocket('wss://gasdetector.onrender.com/');

    socket.onmessage = (event) => {
    const data = JSON.parse(event.data);

    gasWeight.textContent = `${data.weight.toFixed(1)} kg`;
    gasPercentage.textContent = `${data.percentage}%`;
    batteryLevel.textContent = `${data.battery}%`;

    // Update status text and styling
    gasStatus.innerHTML = `<i class="fas fa-check-circle mr-2"></i> ${data.status}`;
    gasStatus.classList.remove('bg-green-500', 'bg-yellow-500', 'bg-red-500', 'pulse');

    if (data.status === 'normal') {
        gasStatus.classList.add('bg-green-500');
    } else if (data.status === 'low') {
        gasStatus.classList.add('bg-yellow-500');
    } else if (data.status === 'critical') {
        gasStatus.classList.add('bg-red-500', 'pulse');
    }

    batteryStatus.innerHTML = `<i class="fas fa-check-circle mr-2"></i> ${data.batteryStatus}`;
    batteryStatus.classList.remove('bg-green-500', 'bg-yellow-500', 'bg-red-500');

    if (data.batteryStatus === 'good') {
    batteryStatus.classList.add('bg-green-500');
    } else if (data.batteryStatus === 'low') {
    batteryStatus.classList.add('bg-yellow-500');
    } else if (data.batteryStatus === 'critical') {
    batteryStatus.classList.add('bg-red-500', 'pulse');
    }


    // Optional alert
    alertContainer.innerHTML = '';
    if (data.status === 'low' || data.status === 'critical') {
        const alert = document.createElement('div');
        alert.textContent = `Warning: Gas level is ${data.status}!`;
        alert.className = 'alert'; // style this if desired
        alertContainer.appendChild(alert);
    }
};


  socket.onopen = () => {
    console.log('Connected to WebSocket server');
  };

  socket.onerror = (err) => {
    console.error('WebSocket error:', err);
  };
</script>
</body>
</html>
